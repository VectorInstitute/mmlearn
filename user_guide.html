<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark">
    <meta name="google-site-verification" content="i0qQRaR9OA3tSz_9tDocdcXGY27Ox_cy4FrvTHD2C_0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    
      <meta name="description" content="mmlearn Python API documentation">
    <link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Contributing to mmlearn" href="contributing.html" /><link rel="prev" title="Installation" href="installation.html" />

    <meta name="generator" content="sphinx-8.1.3, furo 2024.08.06"/>

    
    <meta name="msvalidate.01" content="8D2A5032F006424CAF54C0DDCD16F666" />
      
        <title>User Guide - mmlearn 0.1.0a1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #faad1a;
  --color-brand-content: #eb088a;
  --color-foreground-secondary: #52c7de;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #faad1a;
  --color-brand-content: #eb088a;
  --color-foreground-secondary: #52c7de;
  
      }
    }
  }
</style><script src="_static/documentation_options.js?v=49b5e7b8"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=ccdb6887"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script src="_static/require.min.js?v=53367eec"></script>
    <script src="_static/custom.js?v=275847af"></script>
    
    <script src="https://kit.fontawesome.com/2c1f516901.js" crossorigin="anonymous"></script>

  </head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">mmlearn 0.1.0a1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">mmlearn 0.1.0a1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to mmlearn</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="reference/api/mmlearn.conf.html">mmlearn.conf package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="reference/api/mmlearn.datasets.html">mmlearn.datasets package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of mmlearn.datasets package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="reference/api/mmlearn.datasets.core.html">mmlearn.datasets.core package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of mmlearn.datasets.core package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.datasets.core.combined_dataset.html">mmlearn.datasets.core.combined_dataset module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.datasets.core.data_collator.html">mmlearn.datasets.core.data_collator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.datasets.core.example.html">mmlearn.datasets.core.example module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.datasets.core.modalities.html">mmlearn.datasets.core.modalities module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.datasets.core.samplers.html">mmlearn.datasets.core.samplers module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="reference/api/mmlearn.datasets.processors.html">mmlearn.datasets.processors package</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of mmlearn.datasets.processors package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.datasets.processors.masking.html">mmlearn.datasets.processors.masking module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.datasets.processors.tokenizers.html">mmlearn.datasets.processors.tokenizers module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.datasets.processors.transforms.html">mmlearn.datasets.processors.transforms module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.datasets.chexpert.html">mmlearn.datasets.chexpert module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.datasets.imagenet.html">mmlearn.datasets.imagenet module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.datasets.librispeech.html">mmlearn.datasets.librispeech module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.datasets.llvip.html">mmlearn.datasets.llvip module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.datasets.nihcxr.html">mmlearn.datasets.nihcxr module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.datasets.nyuv2.html">mmlearn.datasets.nyuv2 module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.datasets.sunrgbd.html">mmlearn.datasets.sunrgbd module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reference/api/mmlearn.hf_utils.html">mmlearn.hf_utils module</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="reference/api/mmlearn.modules.html">mmlearn.modules package</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of mmlearn.modules package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="reference/api/mmlearn.modules.encoders.html">mmlearn.modules.encoders package</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of mmlearn.modules.encoders package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.encoders.clip.html">mmlearn.modules.encoders.clip module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.encoders.text.html">mmlearn.modules.encoders.text module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.encoders.vision.html">mmlearn.modules.encoders.vision module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="reference/api/mmlearn.modules.layers.html">mmlearn.modules.layers package</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of mmlearn.modules.layers package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.layers.attention.html">mmlearn.modules.layers.attention module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.layers.embedding.html">mmlearn.modules.layers.embedding module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.layers.logit_scaling.html">mmlearn.modules.layers.logit_scaling module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.layers.mlp.html">mmlearn.modules.layers.mlp module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.layers.normalization.html">mmlearn.modules.layers.normalization module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.layers.patch_dropout.html">mmlearn.modules.layers.patch_dropout module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.layers.transformer_block.html">mmlearn.modules.layers.transformer_block module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="reference/api/mmlearn.modules.losses.html">mmlearn.modules.losses package</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of mmlearn.modules.losses package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.losses.contrastive.html">mmlearn.modules.losses.contrastive module</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.losses.data2vec.html">mmlearn.modules.losses.data2vec module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="reference/api/mmlearn.modules.lr_schedulers.html">mmlearn.modules.lr_schedulers package</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of mmlearn.modules.lr_schedulers package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.lr_schedulers.linear_warmup_cosine_lr.html">mmlearn.modules.lr_schedulers.linear_warmup_cosine_lr module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="reference/api/mmlearn.modules.metrics.html">mmlearn.modules.metrics package</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of mmlearn.modules.metrics package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="reference/api/mmlearn.modules.metrics.retrieval_recall.html">mmlearn.modules.metrics.retrieval_recall module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.modules.ema.html">mmlearn.modules.ema module</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="reference/api/mmlearn.tasks.html">mmlearn.tasks package</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of mmlearn.tasks package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.tasks.base.html">mmlearn.tasks.base module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.tasks.contrastive_pretraining.html">mmlearn.tasks.contrastive_pretraining module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.tasks.hooks.html">mmlearn.tasks.hooks module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.tasks.ijepa.html">mmlearn.tasks.ijepa module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.tasks.zero_shot_classification.html">mmlearn.tasks.zero_shot_classification module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/api/mmlearn.tasks.zero_shot_retrieval.html">mmlearn.tasks.zero_shot_retrieval module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="user-guide">
<h1>User Guide<a class="headerlink" href="#user-guide" title="Link to this heading">¶</a></h1>
<p><em>mmlearn</em> contains a collection of tools and utilities to help researchers and practitioners easily set up and run training
or evaluation experiments for multimodal representation learning methods. The toolkit is designed to be modular and extensible.
We aim to provide a high degree of flexibility in using existing methods, while also allowing users to easily add support
for new modalities of data, datasets, models and pretraining or evaluation methods.</p>
<p>Much of the power and flexibility of <em>mmlearn</em> comes from building on top of the <a class="reference external" href="https://lightning.ai/docs/pytorch/stable/">PyTorch Lightning</a>
framework and using <a class="reference external" href="https://hydra.cc/docs/intro/">Hydra</a> and <a class="reference external" href="https://mit-ll-responsible-ai.github.io/hydra-zen/">hydra-zen</a>
for configuration management. Together, these tools make it easy to define and run experiments with different configurations,
and to scale up experiments to run on a SLURM cluster.</p>
<p>The goal of this guide is to give you a brief overview of what <em>mmlearn</em> is and how you can get started using it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>mmlearn</em> currently only supports training and evaluation of encoder-only models.</p>
<p>For more detailed information on the features and capabilities of <em>mmlearn</em>, please refer to the <a class="reference internal" href="api.html"><span class="doc">API Reference</span></a>.</p>
</div>
<section id="defining-a-dataset">
<h2>Defining a Dataset<a class="headerlink" href="#defining-a-dataset" title="Link to this heading">¶</a></h2>
<p>Datasets in <em>mmlearn</em> can be defined using PyTorch’s <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a> or <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.IterableDataset" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">IterableDataset</span></code></a>
classes. However, there are two additional requirements for datasets in <em>mmlearn</em>:</p>
<ol class="arabic simple">
<li><p>The dataset must return an instance of <a class="reference internal" href="reference/api/mmlearn.datasets.core.example.Example.html#mmlearn.datasets.core.example.Example" title="mmlearn.datasets.core.example.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a> from the <code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code>
method or the <code class="xref py py-meth docutils literal notranslate"><span class="pre">__iter__()</span></code> method.</p></li>
<li><p>The <a class="reference internal" href="reference/api/mmlearn.datasets.core.example.Example.html#mmlearn.datasets.core.example.Example" title="mmlearn.datasets.core.example.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a> object returned by the dataset must contain the key <code class="docutils literal notranslate"><span class="pre">'example_index'</span></code>
and use modality-specific keys from the <a class="reference internal" href="reference/api/mmlearn.datasets.core.modalities.ModalityRegistry.html#mmlearn.datasets.core.modalities.ModalityRegistry" title="mmlearn.datasets.core.modalities.ModalityRegistry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Modalities</span></code></a> registry
to store the data.</p></li>
</ol>
<p><strong>Example 1</strong>: Defining a map-style dataset in <em>mmlearn</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mmlearn.datasets.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Example</span><span class="p">,</span> <span class="n">Modalities</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mmlearn.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">EXAMPLE_INDEX_KEY</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MyMapStyleDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">[</span><span class="n">Example</span><span class="p">]):</span>
   <span class="o">...</span>
   <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Example</span><span class="p">:</span>
      <span class="o">...</span>
      <span class="k">return</span> <span class="n">Example</span><span class="p">(</span>
         <span class="p">{</span>
            <span class="n">EXAMPLE_INDEX_KEY</span><span class="p">:</span> <span class="n">idx</span><span class="p">,</span>
            <span class="n">Modalities</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
            <span class="n">Modalities</span><span class="o">.</span><span class="n">RGB</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
            <span class="n">Modalities</span><span class="o">.</span><span class="n">RGB</span><span class="o">.</span><span class="n">target</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
            <span class="n">Modalities</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">mask</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
            <span class="o">...</span>
         <span class="p">}</span>
      <span class="p">)</span>
</pre></div>
</div>
<p><strong>Example 2</strong>: Defining an iterable-style dataset in <em>mmlearn</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">IterableDataset</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mmlearn.datasets.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Example</span><span class="p">,</span> <span class="n">Modalities</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mmlearn.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">EXAMPLE_INDEX_KEY</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MyIterableStyleDataset</span><span class="p">(</span><span class="n">IterableDataset</span><span class="p">[</span><span class="n">Example</span><span class="p">]):</span>
   <span class="o">...</span>
   <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Example</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
      <span class="o">...</span>
      <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
         <span class="k">yield</span> <span class="n">Example</span><span class="p">(</span>
            <span class="p">{</span>
               <span class="n">EXAMPLE_INDEX_KEY</span><span class="p">:</span> <span class="n">idx</span><span class="p">,</span>
               <span class="n">Modalities</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
               <span class="n">Modalities</span><span class="o">.</span><span class="n">AUDIO</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
               <span class="n">Modalities</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">mask</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
               <span class="n">Modalities</span><span class="o">.</span><span class="n">AUDIO</span><span class="o">.</span><span class="n">mask</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
               <span class="o">...</span>
            <span class="p">}</span>
         <span class="p">)</span>
         <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="reference/api/mmlearn.datasets.core.example.Example.html#mmlearn.datasets.core.example.Example" title="mmlearn.datasets.core.example.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a> class represents a single example in the dataset and all the attributes
associated with it. The class is an extension of the <a class="reference external" href="https://docs.python.org/3.10/library/collections.html#collections.OrderedDict" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></a> class that provides attribute-style access
to the dictionary values and handles the creation of the <code class="docutils literal notranslate"><span class="pre">'example_ids'</span></code> tuple, combining the <code class="docutils literal notranslate"><span class="pre">'example_index'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'dataset_index'</span></code> values. The <code class="docutils literal notranslate"><span class="pre">'example_index'</span></code> key is created by the dataset object for each example returned by the
dataset. On the other hand, the <code class="docutils literal notranslate"><span class="pre">'dataset_index'</span></code> key is created by the <a class="reference internal" href="reference/api/mmlearn.datasets.core.combined_dataset.CombinedDataset.html#mmlearn.datasets.core.combined_dataset.CombinedDataset" title="mmlearn.datasets.core.combined_dataset.CombinedDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">CombinedDataset</span></code></a>
each <a class="reference internal" href="reference/api/mmlearn.datasets.core.example.Example.html#mmlearn.datasets.core.example.Example" title="mmlearn.datasets.core.example.Example"><code class="xref py py-class docutils literal notranslate"><span class="pre">Example</span></code></a> object returned by the dataset.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All dataset objects in <em>mmlearn</em> are wrapped in the <a class="reference internal" href="reference/api/mmlearn.datasets.core.combined_dataset.CombinedDataset.html#mmlearn.datasets.core.combined_dataset.CombinedDataset" title="mmlearn.datasets.core.combined_dataset.CombinedDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">CombinedDataset</span></code></a> class,
which is a subclass of <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.Dataset</span></code></a>. As such, the user almost never has to add/define the <code class="docutils literal notranslate"><span class="pre">'dataset_index'</span></code>
key explicitly.</p>
<p>Since batching typically combines data from the same modality into one tensor, both the <code class="docutils literal notranslate"><span class="pre">'example_index'</span></code> and <code class="docutils literal notranslate"><span class="pre">'dataset_index'</span></code>
keys are essential for uniquely identifying paired examples across different modalities from the same dataset. The
<a class="reference internal" href="reference/api/mmlearn.datasets.core.example.html#mmlearn.datasets.core.example.find_matching_indices" title="mmlearn.datasets.core.example.find_matching_indices"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_matching_indices()</span></code></a> function does exactly this by finding the indices of the
examples in a batch that have the same <code class="docutils literal notranslate"><span class="pre">'example_ids'</span></code> tuple.</p>
</div>
<p><code class="xref py py-data docutils literal notranslate"><span class="pre">Modalities</span></code> is an instance of <a class="reference internal" href="reference/api/mmlearn.datasets.core.modalities.ModalityRegistry.html#mmlearn.datasets.core.modalities.ModalityRegistry" title="mmlearn.datasets.core.modalities.ModalityRegistry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModalityRegistry</span></code></a>
singleton class that serves as a global registry for all the modalities supported by <em>mmlearn</em>. It allows dot-style access
registered modalities and their properties. For example, the <code class="docutils literal notranslate"><span class="pre">'RGB'</span></code> modality can be accessed using  <code class="xref py py-data docutils literal notranslate"><span class="pre">Modalities.RGB</span></code>
(returns string <code class="docutils literal notranslate"><span class="pre">'rgb'</span></code>) and the <code class="docutils literal notranslate"><span class="pre">'target'</span></code> property of the <code class="docutils literal notranslate"><span class="pre">'RGB'</span></code> modality can be accessed using <code class="xref py py-data docutils literal notranslate"><span class="pre">Modalities.RGB.target</span></code>
(returns the string <code class="docutils literal notranslate"><span class="pre">'rgb_target'</span></code>). It also provides a method to register new modalities and their properties. For example,
the following code snippet shows how to register a new <code class="docutils literal notranslate"><span class="pre">'DNA'</span></code> modality:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mmlearn.datasets.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Modalities</span>

<span class="n">Modalities</span><span class="o">.</span><span class="n">register_modality</span><span class="p">(</span><span class="s2">&quot;dna&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="adding-new-modules">
<h2>Adding New Modules<a class="headerlink" href="#adding-new-modules" title="Link to this heading">¶</a></h2>
<p>Modules are building blocks for models and tasks in <em>mmlearn</em>. They can be anything from encoders, layers, losses, optimizers,
learning rate schedulers, metrics, etc. Modules in <em>mmlearn</em> are generally defined by extending PyTorch’s <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">nn.Module</span></code></a>
class.</p>
<p>Users have the flexibility to design new modules according to their requirements, with the exception of encoder modules
and modules associated with specific pre-defined tasks (e.g., loss functions for the <a class="reference internal" href="reference/api/mmlearn.tasks.contrastive_pretraining.ContrastivePretraining.html#mmlearn.tasks.contrastive_pretraining.ContrastivePretraining" title="mmlearn.tasks.contrastive_pretraining.ContrastivePretraining"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContrastivePretraining</span></code></a> task).
The forward method of encoder modules must accept a dictionary as input, where the keys are the names of the modalities
and the values are the corresponding (batched) tensors/data. This format makes it easier to reuse the encoder with different
modalities and different tasks. In addition, the forward method must return a list-like object where the first element is
the last layer’s output. The following code snippet shows how to define a new text encoder module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">nn</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mmlearn.datasets.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Modalities</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MyTextEncoder</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
   <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">output_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="o">...</span>

   <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
      <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span>
         <span class="n">inputs</span><span class="p">[</span><span class="n">Modalities</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
         <span class="n">inputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;attention_mask&quot;</span><span class="p">,</span> <span class="n">inputs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Modalities</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">attention_mask</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
         <span class="p">),</span>
      <span class="p">)</span>
      <span class="k">return</span> <span class="p">(</span><span class="n">out</span><span class="p">,)</span>
</pre></div>
</div>
<p>For modules associated with pre-defined tasks, the new modules must adhere to the same function signature as the existing
modules for that task. For instance, the forward method of a new loss function for the <a class="reference internal" href="reference/api/mmlearn.tasks.contrastive_pretraining.ContrastivePretraining.html#mmlearn.tasks.contrastive_pretraining.ContrastivePretraining" title="mmlearn.tasks.contrastive_pretraining.ContrastivePretraining"><code class="xref py py-class docutils literal notranslate"><span class="pre">ContrastivePretraining</span></code></a>
task must have the following signature to be compatible with the existing loss functions for the task:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mmlearn.tasks.contrastive_pretraining</span><span class="w"> </span><span class="kn">import</span> <span class="n">LossPairSpec</span>

<span class="k">def</span><span class="w"> </span><span class="nf">my_contrastive_loss</span><span class="p">(</span>
   <span class="n">embeddings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span>
   <span class="n">example_ids</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span>
   <span class="n">logit_scale</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
   <span class="n">modality_loss_pairs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">LossPairSpec</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
   <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="adding-new-tasks">
<h2>Adding New Tasks<a class="headerlink" href="#adding-new-tasks" title="Link to this heading">¶</a></h2>
<p>Tasks in <em>mmlearn</em> represent the different training and/or evaluation objectives that can be performed on the data using
the different modules. Tasks that require training should extend the <a class="reference internal" href="reference/api/mmlearn.tasks.base.TrainingTask.html#mmlearn.tasks.base.TrainingTask" title="mmlearn.tasks.base.TrainingTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingTask</span></code></a> class, while tasks
involving only evaluation should extend the <a class="reference internal" href="reference/api/mmlearn.tasks.hooks.EvaluationHooks.html#mmlearn.tasks.hooks.EvaluationHooks" title="mmlearn.tasks.hooks.EvaluationHooks"><code class="xref py py-class docutils literal notranslate"><span class="pre">EvaluationHooks</span></code></a> class.</p>
<section id="training-tasks">
<h3>Training Tasks<a class="headerlink" href="#training-tasks" title="Link to this heading">¶</a></h3>
<p>The <a class="reference internal" href="reference/api/mmlearn.tasks.base.TrainingTask.html#mmlearn.tasks.base.TrainingTask" title="mmlearn.tasks.base.TrainingTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingTask</span></code></a> class is an extension of the <a class="reference external" href="https://lightning.ai/docs/pytorch/stable/api/lightning.pytorch.core.LightningModule.html#lightning.pytorch.core.LightningModule" title="(in PyTorch Lightning v2.5.0.post0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code></a>
class, which itself is an extension of the <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a> class. The class provides a common interface for training
tasks in <em>mmlearn</em>. It allows users to define the training loop, validation loop, test loop, and the setup for the model,
optimizer, learning rate scheduler and loss function, all in one place (a functionality inherited from PyTorch Lightning).
The class also provides hooks for customizing the training loop, validation loop, and test loop, as well as a suite of
other functionalities like logging, checkpointing and handling distributed training.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For more information on the features and capabilities of the <a class="reference internal" href="reference/api/mmlearn.tasks.base.TrainingTask.html#mmlearn.tasks.base.TrainingTask" title="mmlearn.tasks.base.TrainingTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingTask</span></code></a> class inherited
from PyTorch Lightning, please refer to the PyTorch Lightning <a class="reference external" href="https://lightning.ai/docs/pytorch/stable/">documentation</a>.</p>
</div>
<p>To be used with the PyTorch Lightning Trainer, extensions of the <a class="reference internal" href="reference/api/mmlearn.tasks.base.TrainingTask.html#mmlearn.tasks.base.TrainingTask" title="mmlearn.tasks.base.TrainingTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingTask</span></code></a> class must define
a <cite>training_step</cite> method. The following code snippet shows the minimum requirements for defining a new task in <em>mmlearn</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mmlearn.tasks.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainingTask</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyTask</span><span class="p">(</span><span class="n">TrainingTask</span><span class="p">):</span>
   <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
      <span class="bp">self</span><span class="p">,</span>
      <span class="n">optimizer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">partial</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">]],</span>
      <span class="n">loss_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">],</span>
      <span class="n">lr_scheduler</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
         <span class="n">Union</span><span class="p">[</span>
            <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">partial</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">LRScheduler</span><span class="p">],</span> <span class="n">Any</span><span class="p">]],</span>
            <span class="n">partial</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">LRScheduler</span><span class="p">],</span>
         <span class="p">]</span>
      <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
   <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">lr_scheduler</span><span class="o">=</span><span class="n">lr_scheduler</span><span class="p">)</span>

      <span class="c1"># Since this class also inherits from torch.nn.Module, we can define the</span>
      <span class="c1"># model and its components directly in the constructor and also define</span>
      <span class="c1"># a forward method for the model as an instance method of this class.</span>
      <span class="c1"># Alternatively, we can pass the model as an argument to the constructor</span>
      <span class="c1"># and assign it to an instance variable.</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="o">...</span>

   <span class="k">def</span><span class="w"> </span><span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">batch_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
      <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span> <span class="c1"># or self(batch) if a forward method is defined in this class</span>

      <span class="c1"># maybe process outputs here</span>

      <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">loss</span>
</pre></div>
</div>
</section>
<section id="evaluation-tasks">
<h3>Evaluation Tasks<a class="headerlink" href="#evaluation-tasks" title="Link to this heading">¶</a></h3>
<p>The <a class="reference internal" href="reference/api/mmlearn.tasks.hooks.EvaluationHooks.html#mmlearn.tasks.hooks.EvaluationHooks" title="mmlearn.tasks.hooks.EvaluationHooks"><code class="xref py py-class docutils literal notranslate"><span class="pre">EvaluationHooks</span></code></a> class is intended to be used for evaluation tasks that don’t require training,
e.g. zero-shot evaluation tasks (as opposed to evaluation tasks like linear probing, which require training). The class provides
an interface for defining and customizing the evaluation loop.</p>
<p>Classes that inherit from <a class="reference internal" href="reference/api/mmlearn.tasks.hooks.EvaluationHooks.html#mmlearn.tasks.hooks.EvaluationHooks" title="mmlearn.tasks.hooks.EvaluationHooks"><code class="xref py py-class docutils literal notranslate"><span class="pre">EvaluationHooks</span></code></a> cannot be run/used on their own. They must be used
in conjunction with a training task, which will call the hooks defined in the evaluation task during the evaluation phase.
This way, multiple evaluation tasks can be defined and used with the same training task. The model to be evaluated is
provided by the training task to the evaluation task.</p>
<p>Training tasks that wish to use one or more evaluation tasks must accept an instance of the evaluation task(s) as an argument
to the constructor and must define a <code class="docutils literal notranslate"><span class="pre">validation_step</span></code> and/or <code class="docutils literal notranslate"><span class="pre">test_step</span></code> method that calls the <code class="docutils literal notranslate"><span class="pre">evaluation_step</span></code> method
of the evaluation task(s).</p>
</section>
</section>
<section id="creating-and-configuring-a-project">
<h2>Creating and Configuring a Project<a class="headerlink" href="#creating-and-configuring-a-project" title="Link to this heading">¶</a></h2>
<p>A project in <em>mmlearn</em> can be thought of as a collection of related experiments. Within a project, you can reuse components
from <em>mmlearn</em> (e.g., datasets, models, tasks) or define new ones and use them all together for experiments.</p>
<p>To create a new project, create a new directory following the structure below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>my_project/
├──<span class="w"> </span>configs/
│<span class="w">   </span>├──<span class="w"> </span>__init__.py
│<span class="w">   </span>└──<span class="w"> </span>experiment/
│<span class="w">       </span>├──<span class="w"> </span>my_experiment.yaml
├──<span class="w"> </span>README.md<span class="w"> </span><span class="o">(</span>optional<span class="o">)</span>
├──<span class="w"> </span>requirements.txt<span class="w"> </span><span class="o">(</span>optional<span class="o">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">configs/</span></code> directory contains all the configurations, both <a class="reference external" href="https://hydra.cc/docs/tutorials/structured_config/intro/">structured configs</a>
and YAML config files for the experiments in the project. The <code class="docutils literal notranslate"><span class="pre">configs/experiment/</span></code> directory contains the <cite>.yaml</cite> files
for the experiments associated with the project. These <cite>.yaml</cite> files use the <a class="reference external" href="https://hydra.cc/docs/tutorials/basic/your_first_app/composition/">Hydra configuration format</a>,
which also allows overriding the configuration options/values from the command line.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file in the <code class="docutils literal notranslate"><span class="pre">configs/</span></code> directory is required to make the <code class="docutils literal notranslate"><span class="pre">configs/</span></code> directory a Python package,
allowing hydra to compose configurations from <cite>.yaml</cite> files as well as structured configs from python modules. More on this
in the next section.</p>
<p>Optionally, you can also include a <code class="docutils literal notranslate"><span class="pre">README.md</span></code> file with a brief description of the project and a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file
with the dependencies required to run the project.</p>
<section id="specifying-configurable-components">
<h3>Specifying Configurable Components<a class="headerlink" href="#specifying-configurable-components" title="Link to this heading">¶</a></h3>
<p>One of the key features of the Hydra configuration system is the ability to compose configurations from multiple sources,
including the command line, <cite>.yaml</cite> files and structured configs from Python modules. <a class="reference external" href="https://hydra.cc/docs/tutorials/structured_config/intro/">Structured Configs</a>
in Hydra use Python <a class="reference external" href="https://docs.python.org/3.10/library/dataclasses.html#dataclasses.dataclass" title="(in Python v3.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">dataclass()</span></code></a> to define the configuration schema. This allows for both static and runtime type-checking
of the configuration. <a class="reference external" href="https://mit-ll-responsible-ai.github.io/hydra-zen/">Hydra-zen</a> extends Hydra to makes it easy
to dynamically generate dataclass-backed configurations for any class or function simply by adding a decorator to the class
or function.</p>
<p><em>mmlearn</em> provides a pre-populated <a class="reference external" href="https://hydra.cc/docs/tutorials/structured_config/config_store/">config store</a>,
<a class="reference internal" href="reference/api/mmlearn.conf.html#mmlearn.conf.external_store" title="mmlearn.conf.external_store"><code class="xref py py-data docutils literal notranslate"><span class="pre">external_store</span></code></a>, which can be used as a decorator to register configurable components. This config
store already contains configurations for common components like PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/optim.html#module-torch.optim" title="(in PyTorch v2.6)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optimizers</span></code></a>,
<a class="reference external" href="https://pytorch.org/docs/stable/optim.html#module-torch.optim.lr_scheduler" title="(in PyTorch v2.6)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">learning</span> <span class="pre">rate</span> <span class="pre">schedulers</span></code></a>, loss functions and samplers,
as well as PyTorch Lightning’s Trainer <code class="xref py py-mod docutils literal notranslate"><span class="pre">callbacks</span></code> and <code class="xref py py-mod docutils literal notranslate"><span class="pre">loggers</span></code>.
To dynamically add new configurable components to the store, simply add the <a class="reference internal" href="reference/api/mmlearn.conf.html#mmlearn.conf.external_store" title="mmlearn.conf.external_store"><code class="xref py py-data docutils literal notranslate"><span class="pre">external_store</span></code></a> decorator
to the class or function definition.</p>
<p>For example, the following code snippet shows how to register a new dataset class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mmlearn.conf</span><span class="w"> </span><span class="kn">import</span> <span class="n">external_store</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mmlearn.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">EXAMPLE_INDEX_KEY</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mmlearn.datasets.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Example</span><span class="p">,</span> <span class="n">Modalities</span>


<span class="nd">@external_store</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="s2">&quot;datasets&quot;</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyMapStyleDataset</span><span class="p">(</span><span class="n">Dataset</span><span class="p">[</span><span class="n">Example</span><span class="p">]):</span>
   <span class="o">...</span>
   <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Example</span><span class="p">:</span>
      <span class="o">...</span>
      <span class="k">return</span> <span class="n">Example</span><span class="p">(</span>
         <span class="p">{</span>
            <span class="n">EXAMPLE_INDEX_KEY</span><span class="p">:</span> <span class="n">idx</span><span class="p">,</span>
            <span class="n">Modalities</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
            <span class="n">Modalities</span><span class="o">.</span><span class="n">RGB</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
            <span class="n">Modalities</span><span class="o">.</span><span class="n">RGB</span><span class="o">.</span><span class="n">target</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
            <span class="n">Modalities</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">mask</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
            <span class="o">...</span>
         <span class="p">}</span>
      <span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="reference/api/mmlearn.conf.html#mmlearn.conf.external_store" title="mmlearn.conf.external_store"><code class="xref py py-data docutils literal notranslate"><span class="pre">external_store</span></code></a> decorator immediately add the class to the config store once the Python interpreter
loads the module containing the class. This is why the <code class="docutils literal notranslate"><span class="pre">configs/</span></code> directory must be a Python package and why modules
containing user-defined configurable components must be imported in the <code class="docutils literal notranslate"><span class="pre">configs/__init__.py</span></code> file.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">group</span></code> argument specifies the <a class="reference external" href="https://hydra.cc/docs/tutorials/basic/your_first_app/config_groups/">config group</a>
under which the configurable component will be registered. This allows users to easily reference the component in the
configurations using the group name and the class name. The available config groups in <em>mmlearn</em> are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datasets</span></code>: Contains all the dataset classes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datasets/masking</span></code>: Contains all the configurable classes and functions for masking input data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datasets/tokenizers</span></code>: Contains all the configurable classes and functions for converting raw inputs to tokens.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datasets/transforms</span></code>: Contains all the configurable classes and functions for transforming input data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dataloader/sampler</span></code>: Contains all the dataloader sampler classes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modules/encoders</span></code>: Contains all the encoder modules.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modules/layers</span></code>: For layers that can be used independent of the model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modules/losses</span></code>: Contains all the loss functions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modules/optimizers</span></code>: Contains all the optimizers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modules/lr_schedulers</span></code>: Contains all the learning rate schedulers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modules/metrics</span></code>: Contains all the evaluation metrics.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tasks</span></code>: Contains all the task classes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trainer/callbacks</span></code>: Contains all the PyTorch Lightning Trainer callbacks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trainer/logger</span></code>: Contains all the PyTorch Lightning Trainer loggers.</p></li>
</ul>
</section>
<section id="the-base-configuration">
<h3>The Base Configuration<a class="headerlink" href="#the-base-configuration" title="Link to this heading">¶</a></h3>
<p>The base configuration for all experiments in <em>mmlearn</em> are defined in the <a class="reference internal" href="reference/api/mmlearn.conf.MMLearnConf.html#mmlearn.conf.MMLearnConf" title="mmlearn.conf.MMLearnConf"><code class="xref py py-class docutils literal notranslate"><span class="pre">MMLearnConf</span></code></a>
dataclass. This serves as the base configuration for all experiments and can be extended to include additional configuration
options, following Hydra’s <a class="reference external" href="https://hydra.cc/docs/advanced/override_grammar/basic/">override syntax</a>.</p>
<p>The base configuration for <em>mmlearn</em> is shown below:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">experiment_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">job_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">train</span>
<span class="nt">seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">datasets</span><span class="p">:</span>
<span class="w">   </span><span class="nt">train</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">val</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">test</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">dataloader</span><span class="p">:</span>
<span class="w">   </span><span class="nt">train</span><span class="p">:</span>
<span class="w">      </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.utils.data.dataloader.DataLoader</span>
<span class="w">      </span><span class="nt">_convert_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">      </span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">      </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">sampler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">batch_sampler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">num_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">      </span><span class="nt">collate_fn</span><span class="p">:</span>
<span class="w">         </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mmlearn.datasets.core.data_collator.DefaultDataCollator</span>
<span class="w">         </span><span class="nt">batch_processors</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">pin_memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">drop_last</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0</span>
<span class="w">      </span><span class="nt">worker_init_fn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">multiprocessing_context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">generator</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">prefetch_factor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">persistent_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="nt">pin_memory_device</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">   </span><span class="nt">val</span><span class="p">:</span>
<span class="w">      </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.utils.data.dataloader.DataLoader</span>
<span class="w">      </span><span class="nt">_convert_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">      </span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">      </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">sampler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">batch_sampler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">num_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">      </span><span class="nt">collate_fn</span><span class="p">:</span>
<span class="w">         </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mmlearn.datasets.core.data_collator.DefaultDataCollator</span>
<span class="w">         </span><span class="nt">batch_processors</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">pin_memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">drop_last</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0</span>
<span class="w">      </span><span class="nt">worker_init_fn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">multiprocessing_context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">generator</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">prefetch_factor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">persistent_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="nt">pin_memory_device</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">   </span><span class="nt">test</span><span class="p">:</span>
<span class="w">      </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch.utils.data.dataloader.DataLoader</span>
<span class="w">      </span><span class="nt">_convert_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<span class="w">      </span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">      </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">sampler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">batch_sampler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">num_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">      </span><span class="nt">collate_fn</span><span class="p">:</span>
<span class="w">         </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mmlearn.datasets.core.data_collator.DefaultDataCollator</span>
<span class="w">         </span><span class="nt">batch_processors</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">pin_memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">drop_last</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0</span>
<span class="w">      </span><span class="nt">worker_init_fn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">multiprocessing_context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">generator</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">prefetch_factor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">      </span><span class="nt">persistent_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">      </span><span class="nt">pin_memory_device</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">trainer</span><span class="p">:</span>
<span class="w">   </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lightning.pytorch.trainer.trainer.Trainer</span>
<span class="w">   </span><span class="nt">accelerator</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auto</span>
<span class="w">   </span><span class="nt">strategy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auto</span>
<span class="w">   </span><span class="nt">devices</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auto</span>
<span class="w">   </span><span class="nt">num_nodes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">   </span><span class="nt">precision</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">logger</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">callbacks</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">fast_dev_run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">   </span><span class="nt">max_epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">min_epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">max_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-1</span>
<span class="w">   </span><span class="nt">min_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">max_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">limit_train_batches</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">limit_val_batches</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">limit_test_batches</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">limit_predict_batches</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">overfit_batches</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0</span>
<span class="w">   </span><span class="nt">val_check_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">check_val_every_n_epoch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">   </span><span class="nt">num_sanity_val_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">log_every_n_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">enable_checkpointing</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">   </span><span class="nt">enable_progress_bar</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">   </span><span class="nt">enable_model_summary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">   </span><span class="nt">accumulate_grad_batches</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">   </span><span class="nt">gradient_clip_val</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">gradient_clip_algorithm</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">deterministic</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">benchmark</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">inference_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">   </span><span class="nt">use_distributed_sampler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">   </span><span class="nt">profiler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">detect_anomaly</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">   </span><span class="nt">barebones</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">   </span><span class="nt">plugins</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">sync_batchnorm</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">   </span><span class="nt">reload_dataloaders_every_n_epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">   </span><span class="nt">default_root_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hydra:runtime.output_dir}/checkpoints</span>
<span class="nt">tags</span><span class="p">:</span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${experiment_name}</span>
<span class="nt">resume_from_checkpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">strict_loading</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">torch_compile_kwargs</span><span class="p">:</span>
<span class="w">   </span><span class="nt">disable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">   </span><span class="nt">fullgraph</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">   </span><span class="nt">dynamic</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">backend</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">inductor</span>
<span class="w">   </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">   </span><span class="nt">options</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</pre></div>
</div>
<p>The config keys with a value of <code class="docutils literal notranslate"><span class="pre">???</span></code> are placeholders that must be overridden in the experiment configurations. While
the <code class="docutils literal notranslate"><span class="pre">dataset</span></code> key in the <code class="docutils literal notranslate"><span class="pre">dataloader</span></code> group is also a placeholder, it should not be provided as it will be automatically
filled in from the <code class="docutils literal notranslate"><span class="pre">datasets</span></code> group.</p>
</section>
<section id="configuring-an-experiment">
<h3>Configuring an Experiment<a class="headerlink" href="#configuring-an-experiment" title="Link to this heading">¶</a></h3>
<p>To configure an experiment, create a new <cite>.yaml</cite> file in the <code class="docutils literal notranslate"><span class="pre">configs/experiment/</span></code> directory of the project. The configuration
file should define the experiment-specific configuration options and override the base configuration options as needed.
Configurable components from the config store can be referenced by name in the configuration file under the
<a class="reference external" href="https://hydra.cc/docs/advanced/defaults_list/">defaults list</a>. The following code snippet shows an example configuration
file for an experiment:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># @package _global_</span>

<span class="nt">defaults</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/datasets@datasets.train.my_iterable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MyIterableStyleDataset</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/datasets@datasets.train.my_map</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MyMapStyleDataset</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/modules/encoders@task.encoders.text</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MyTextEncoder</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/modules/encoders@task.encoders.rgb</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MyRGBEncoder</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/modules/losses@task.loss</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ContrastiveLoss</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/modules/optimizers@task.optimizer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AdamW</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/modules/lr_schedulers@task.lr_scheduler.scheduler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CosineAnnealingLR</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/eval_task@task.evaluation_tasks.retrieval.task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ZeroShotCrossModalRetrieval</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/trainer/callbacks@trainer.callbacks.lr_monitor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LearningRateMonitor</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/trainer/callbacks@trainer.callbacks.model_checkpoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ModelCheckpoint</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/trainer/callbacks@trainer.callbacks.early_stopping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EarlyStopping</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/trainer/callbacks@trainer.callbacks.model_summary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ModelSummary</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">/trainer/logger@trainer.logger.wandb</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WandbLogger</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">override /task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ContrastivePretraining</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_self_</span>

<span class="nt">seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span>

<span class="nt">datasets</span><span class="p">:</span>
<span class="w">   </span><span class="nt">train</span><span class="p">:</span>
<span class="w">      </span><span class="nt">my_iterable</span><span class="p">:</span>
<span class="w">         </span><span class="nt">my_iterable_arg1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="nt">my_map</span><span class="p">:</span>
<span class="w">         </span><span class="nt">my_map_arg1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>

<span class="nt">dataloader</span><span class="p">:</span>
<span class="w">   </span><span class="nt">train</span><span class="p">:</span>
<span class="w">      </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>

<span class="nt">task</span><span class="p">:</span>
<span class="w">   </span><span class="nt">encoders</span><span class="p">:</span>
<span class="w">      </span><span class="nt">text</span><span class="p">:</span>
<span class="w">         </span><span class="nt">text_arg1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="nt">rgb</span><span class="p">:</span>
<span class="w">         </span><span class="nt">rgb_arg1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">   </span><span class="nt">evaluation_tasks</span><span class="p">:</span>
<span class="w">      </span><span class="nt">retrieval</span><span class="p">:</span>
<span class="w">         </span><span class="nt">task</span><span class="p">:</span>
<span class="w">         </span><span class="nt">task_specs</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">query_modality</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text</span>
<span class="w">               </span><span class="l l-Scalar l-Scalar-Plain">target_modality</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rgb</span>
<span class="w">               </span><span class="l l-Scalar l-Scalar-Plain">top_k</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">200</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">query_modality</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rgb</span>
<span class="w">               </span><span class="l l-Scalar l-Scalar-Plain">target_modality</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text</span>
<span class="w">               </span><span class="l l-Scalar l-Scalar-Plain">top_k</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">200</span><span class="p p-Indicator">]</span>
<span class="w">         </span><span class="nt">run_on_validation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">         </span><span class="nt">run_on_test</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</section>
</section>
<section id="running-an-experiment">
<h2>Running an Experiment<a class="headerlink" href="#running-an-experiment" title="Link to this heading">¶</a></h2>
<p>To run an experiment locally, use the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mmlearn_run<span class="w"> </span><span class="s1">&#39;hydra.searchpath=[pkg://path.to.my_project.configs]&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>+experiment<span class="o">=</span>my_experiment<span class="w"> </span><span class="se">\</span>
<span class="w">   </span><span class="nv">experiment_name</span><span class="o">=</span>my_experiment_name
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can see the full config for an experiment without running it by adding the <code class="docutils literal notranslate"><span class="pre">--help</span></code> flag to the command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mmlearn_run<span class="w"> </span><span class="s1">&#39;hydra.searchpath=[pkg://path.to.my_project.configs]&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>+experiment<span class="o">=</span>my_experiment<span class="w"> </span><span class="se">\</span>
<span class="w">   </span><span class="nv">experiment_name</span><span class="o">=</span>my_experiment_name<span class="w"> </span><span class="se">\</span>
<span class="w">   </span><span class="nv">task</span><span class="o">=</span>my_task<span class="w"> </span><span class="se">\ </span><span class="c1"># required for the command to run</span>
<span class="w">   </span>--help
</pre></div>
</div>
</div>
<p>To run the experiment on a SLURM cluster, use the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mmlearn_run<span class="w"> </span>--multirun<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>hydra.launcher.mem_per_cpu<span class="o">=</span>5G<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>hydra.launcher.qos<span class="o">=</span>your_qos<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>hydra.launcher.partition<span class="o">=</span>your_partition<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>hydra.launcher.gres<span class="o">=</span>gpu:4<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>hydra.launcher.cpus_per_task<span class="o">=</span><span class="m">8</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>hydra.launcher.tasks_per_node<span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>hydra.launcher.nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>hydra.launcher.stderr_to_stdout<span class="o">=</span><span class="nb">true</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>hydra.launcher.timeout_min<span class="o">=</span><span class="m">720</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span><span class="s1">&#39;hydra.searchpath=[pkg://path.to.my_project.configs]&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span>+experiment<span class="o">=</span>my_experiment<span class="w"> </span><span class="se">\</span>
<span class="w">   </span><span class="nv">experiment_name</span><span class="o">=</span>my_experiment_name
</pre></div>
</div>
<p>This uses the <a class="reference external" href="https://hydra.cc/docs/plugins/submitit_launcher/">submitit launcher</a> plugin built into Hydra to submit
the experiment to the SLURM scheduler with the specified resources.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After the job is submitted, it is okay to cancel the program with <code class="docutils literal notranslate"><span class="pre">Ctrl+C</span></code>. The job will continue running on
the cluster. You can also add <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> at the end of the command to run it in the background.</p>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="contributing.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Contributing to mmlearn</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="installation.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Installation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Vector AI Engineering
            </div>
            <!--
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
            -->
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/VectorInstitute/mmlearn" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        <div class="footer-container" style="text-align: center;">
          <div class="logo">
            <a class="logo" href="https://vectorinstitute.ai/">
              <span class="logo"></span>
              <img alt="Logo of the Vector Institute" style="width:90px; max-width:90px;" src="_static/logos/vector_logo.png" />
            </a>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">User Guide</a><ul>
<li><a class="reference internal" href="#defining-a-dataset">Defining a Dataset</a></li>
<li><a class="reference internal" href="#adding-new-modules">Adding New Modules</a></li>
<li><a class="reference internal" href="#adding-new-tasks">Adding New Tasks</a><ul>
<li><a class="reference internal" href="#training-tasks">Training Tasks</a></li>
<li><a class="reference internal" href="#evaluation-tasks">Evaluation Tasks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-and-configuring-a-project">Creating and Configuring a Project</a><ul>
<li><a class="reference internal" href="#specifying-configurable-components">Specifying Configurable Components</a></li>
<li><a class="reference internal" href="#the-base-configuration">The Base Configuration</a></li>
<li><a class="reference internal" href="#configuring-an-experiment">Configuring an Experiment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-an-experiment">Running an Experiment</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div></body>
</html>